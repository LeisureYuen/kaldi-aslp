#!/bin/bash

# Created on 2016-03-22
# Author: Binbin Zhang

if [ $# != 2 ]; then
    echo "Make mono state fake model, pdf(0) for blank"
    echo "Usage: $0 num_state out_mdl_file"
    echo "eg: $0 215 fake.mdl"
    exit -1;
fi

num_state=$1
mdl_file=$2

{
echo "<TransitionModel>"
echo "<Topology>"
echo "<TopologyEntry>"
echo "<ForPhones>"
# The last phone is the fake phone for blank
for((i=2; i<=$[$num_state+1]; i++)); do 
    echo -n "$i "
done

echo ""
echo "</ForPhones>"
echo "<State> 0 <PdfClass> 0 <Transition> 0 0.5 <Transition> 1 0.5 </State>"
echo "<State> 1 </State>"
echo "</TopologyEntry>"

# for SIL(sil) phone, it's self loop prob is bigger
echo "<TopologyEntry>"
echo "<ForPhones>"
echo "1" # Here should be sil phone id
echo "</ForPhones>"
echo "<State> 0 <PdfClass> 0 <Transition> 0 0.5 <Transition> 1 0.5 </State>"
echo "<State> 1 </State>"
echo "</TopologyEntry>" 
echo "</Topology>"

echo "<Triples> $[$num_state+1]"
for((i=1; i<=$num_state; i++)); do 
    echo "$i 0 $i"
done
echo $[num_state+1] 0 0
echo "</Triples>"
echo "<LogProbs>"
echo -n "[ 0 "
for ((i=1; i<=$[$num_state+1]; i++)); do
    echo -n "-0.693147 -0.693147 "
done
echo "]"
echo "</LogProbs>"
echo "</TransitionModel>"
echo "<DIMENSION> 39 <NUMPDFS> $num_state"
for ((i=1; i<=$[$num_state+1]; i++)); do
    echo "<DiagGMM> 
<GCONSTS>  [ -91.85806 -105.3811 -90.18231 -81.71819 -75.86192 -88.9178 -94.10337 -90.09794 -79.11999 -73.42676 -104.0757 -90.05647 ]
<WEIGHTS>  [ 0.09176866 0.0693471 0.1006513 0.08479189 0.08923849 0.09679904 0.07704895 0.07325172 0.1004106 0.0815252 0.0649185 0.07024857 ]
<MEANS_INVVARS>  [
  -0.434286 -0.04628769 0.1226425 0.03316904 0.09964754 0.06003669 0.07843705 0.1177271 0.01077071 0.0004276533 0.007468023 -0.02321345 0.01099224 -1.337529 -0.7308482 -0.4315938 -0.2824236 -0.0653805 0.07307623 0.03483034 0.04329412 0.09525192 0.1039833 -0.01692623 -0.0009072388 0.04565873 1.706336 0.09543054 -0.4549929 -0.5788472 -0.8437977 -0.6518352 -0.6180621 -0.5190169 -0.1728339 -0.168655 -0.07597597 0.09688274 0.003275346 
  -2.25055 -1.066802 0.2379622 -0.09270602 0.2836086 0.1787422 0.1384919 0.1265673 0.02896606 0.06954192 0.02428129 0.04694823 0.06247582 0.1575557 -0.04163085 -0.05664114 -0.01297571 -0.01572412 0.01971041 0.002711009 -0.01609604 -0.01453441 -0.01616754 0.01291764 -0.005154927 0.002407343 1.427294 0.2685956 -0.2149397 -0.04453135 -0.1134212 0.01213619 -0.07032742 0.0005675621 0.004927702 -0.09542535 -0.05397503 -0.1151096 -0.0500683 
  -0.178395 -0.155434 0.03006477 -0.04049806 0.07886193 0.07189972 0.02556029 0.04714751 0.01279047 0.02593376 0.02492581 0.02200535 0.0387123 -0.01155922 -0.02925096 -0.05323004 -0.02533512 0.001590832 0.008229057 -0.007886243 0.01129828 0.04503328 0.0008126535 -0.01709074 0.01320253 0.01735689 0.1814954 0.04785342 -0.208188 -0.01031747 -0.1521419 -0.06721691 -0.04550835 -0.007478965 0.02360984 -0.05330042 -0.1675439 -0.1518485 -0.04357035 
  -0.6830262 -0.160457 -0.01980449 -0.04870092 0.1890306 0.07946206 0.02166112 0.0668582 0.09588752 0.05010905 -0.06337823 -0.01659482 0.06183532 -2.139044 -0.155239 0.3871309 -0.1742784 0.1743163 0.1153281 0.08966792 -0.06591556 -0.0546523 0.06615108 0.04213866 -0.03568843 -0.06168127 1.002865 -1.200915 -0.09444349 -0.3361039 -0.9721573 -0.352903 -0.007483322 -0.05411929 -0.3332235 -0.04349057 0.3253754 0.1381621 -0.1012013 
  -0.2520055 -0.3049997 -0.1632116 -0.02818739 -0.001400075 0.02709502 -0.02330747 0.06730611 0.0779715 0.02488151 -0.02136276 0.04346299 0.09401116 -0.6968111 0.3379096 -0.025557 -0.1051532 0.09371095 0.04220008 0.05443564 -0.0307177 0.03069235 0.01033886 -0.05304643 -0.03603274 0.01676765 -1.800075 0.7078262 0.7535642 -0.3050326 0.265078 0.04071169 0.0570689 -0.2957289 -0.3849007 -0.2467743 -0.2743289 -0.5574492 -0.4072589 
  -0.4277105 -0.1768712 -0.09758607 -0.1028385 -0.004189672 0.08749074 0.001442264 0.005469146 0.03497113 0.04919228 -0.01769193 -0.02928093 0.005152783 -1.673556 0.4057352 0.09775907 -0.2573823 0.2381775 -0.03077532 0.2202151 0.04302979 -0.009004764 0.01293643 -0.008257247 -0.04793526 -0.03272111 0.7011813 -1.883527 0.9903451 0.1751249 0.1491973 -0.08012459 0.0965922 0.3114172 -0.08701532 -0.1199536 0.09099894 0.1421289 0.100366 
  -1.310012 -0.2844711 -0.01789126 -0.3201283 0.04631854 0.1922773 0.1101815 0.04613562 -0.04154599 0.01305229 0.004453823 -0.01720485 -0.02011022 -2.401355 -0.5996192 0.543546 0.1417352 0.1145168 -0.1557082 0.1013938 0.1891841 -0.01417527 -0.1048813 0.004554758 0.05550174 0.06901235 1.928146 -0.9569252 0.2036094 1.329946 0.08940027 -0.2846594 -0.5023283 0.005340087 0.4712184 0.2324843 -0.1110396 0.003572988 0.1890701 
  -0.4251437 -0.145695 -0.1159087 -0.09277794 0.07128034 0.07885235 0.006711651 0.0492122 0.07408955 0.07798723 -0.03747857 -0.03488139 0.04327264 -0.7197483 -0.3446219 -0.1029248 -0.1976706 -0.1944519 -0.07588421 -0.09102501 -0.1143169 -0.09763411 -0.06067262 -0.03139025 -0.02405904 -0.0355008 -0.08023407 0.3103525 1.499454 0.6272552 0.1853511 -0.09314968 0.1095887 -0.05168099 -0.4010847 -0.3647746 0.1868363 0.1453416 -0.2285295 
  -0.8420714 -0.3443332 -0.1682559 -0.2597113 0.07020797 0.08576178 0.004535079 -0.005967967 0.05301245 0.1234374 -0.02759494 -0.04625335 0.02162622 -1.958333 -0.1180051 0.5116369 -0.08429387 0.07717974 -0.002063735 0.111255 0.06524406 -0.0609929 -0.04786231 0.04313846 0.02093757 -0.04779787 -1.144856 -0.8457119 1.194762 0.6584711 0.124381 0.07132374 0.2574476 0.3899162 -0.08521021 -0.482786 -0.1293669 0.07233842 0.08806173 
  -0.2447222 -0.1866426 -0.09079082 -0.1091106 -0.01235398 0.05409429 -0.06427145 0.006648296 -0.0125818 -0.0311419 -0.05463203 -0.04350223 0.01502025 -0.2554129 0.1058907 -0.06232869 -0.05230351 0.01974905 -0.01688977 -0.008828525 -0.02915961 0.006973203 0.03560486 -0.002549999 -0.001096816 0.006307274 -1.210466 0.2451189 0.208066 -0.06017846 0.2853345 0.2069307 0.3936262 0.446972 0.5982723 0.6547437 0.4772058 0.4543828 0.3132436 
  -2.019754 -0.5589255 -0.0606853 -0.223113 0.0748601 0.009678663 0.029442 0.09902936 0.1038012 0.04875551 -0.1008928 -0.02815428 0.06664088 -2.308848 -0.7770106 0.7698527 0.1727054 0.1841264 0.1526109 0.1893472 0.07346795 -0.07135219 0.04985248 0.188603 0.07659554 -0.07010294 -0.7359999 -2.041997 0.8673336 1.792998 0.8845832 0.9366026 0.4140857 -0.1861379 -0.4420766 0.1291577 0.7475666 0.4441351 -0.1139055 
  -0.4429107 -0.2335759 -0.05353741 -0.02856733 -0.02493552 -0.01309228 0.03427789 0.07256435 -0.004353421 -0.04401603 -0.01913374 -0.0154342 0.002203851 -0.46618 -0.1936837 -0.03699899 -0.1392946 0.008442705 0.004332811 -0.07832658 -0.05615168 0.007107971 -0.01899378 -0.06662128 -0.006170131 0.02847413 -0.3801634 0.2438758 1.053814 0.3487108 0.9132372 0.4888179 0.03190595 -0.09683456 0.1984705 0.4573247 0.1534792 0.1164765 0.1514936 ]
<INV_VARS>  [
  0.02862891 0.02157758 0.01445689 0.006123121 0.006700447 0.005799347 0.006558769 0.006749517 0.006170081 0.007794177 0.008776322 0.008689029 0.01075324 1.043275 0.2951672 0.2164266 0.1332341 0.1030122 0.1040531 0.09356082 0.09424036 0.105428 0.1088808 0.1153489 0.1320899 0.1522441 7.824229 2.343949 1.494706 1.011035 0.802868 0.727778 0.6484711 0.5944127 0.6250404 0.6299615 0.6942766 0.7381434 0.798467 
  0.07778483 0.05797688 0.04304537 0.02668449 0.02310785 0.02413526 0.01778542 0.01740823 0.01820312 0.01773373 0.01914644 0.01752887 0.02573146 6.099651 1.720602 0.9898236 0.5484663 0.3965466 0.327565 0.2528366 0.2433914 0.2149195 0.2242119 0.2173661 0.233819 0.2560699 34.85073 11.76497 8.001736 4.692589 3.681807 3.152066 2.585693 2.312387 2.156483 2.25225 2.139351 2.312893 2.747555 
  0.009920621 0.01005612 0.01242261 0.0104877 0.01020751 0.009565004 0.008163956 0.009187155 0.009787011 0.01040548 0.01184948 0.01135001 0.01743036 0.1088127 0.09603181 0.09779204 0.1021897 0.08202654 0.08467808 0.07075542 0.07960585 0.09242934 0.09325865 0.1039279 0.1250426 0.1511804 0.7123842 0.5298799 0.6659712 0.6056052 0.5425832 0.503148 0.456638 0.4939845 0.5260315 0.5426081 0.6165165 0.730243 0.8894799 
  0.03869129 0.03107547 0.01422241 0.0122838 0.01524714 0.009972983 0.01004778 0.008623124 0.01032221 0.010587 0.008806006 0.008045332 0.01460149 2.291306 0.8976105 0.4709271 0.3367175 0.2952316 0.2199716 0.1900703 0.1737765 0.1640364 0.1690472 0.1607214 0.1819484 0.2155214 20.15509 5.765074 3.397343 2.437632 1.975424 1.392503 1.095054 0.9941301 0.9967039 0.9608567 0.9097621 0.9940022 1.15479 
  0.02501928 0.0206458 0.01521182 0.01219261 0.01678697 0.00815424 0.008502914 0.009775773 0.0104005 0.0102097 0.00960685 0.01062005 0.01775113 1.305785 0.7532671 0.6036198 0.4385767 0.3240679 0.259135 0.2274422 0.2033848 0.1892921 0.1794005 0.1759827 0.2161068 0.2465406 18.3681 6.902948 3.585317 2.625706 1.887955 1.455075 1.231365 1.207278 1.13126 1.030821 0.9862196 1.285957 1.398207 
  0.03073043 0.02366115 0.02234923 0.01289381 0.009728855 0.009221118 0.009332111 0.008724497 0.0101378 0.009921798 0.009805918 0.009989084 0.01371562 0.5931121 0.1995923 0.1747393 0.1721007 0.1387792 0.1139115 0.114301 0.09793055 0.1105598 0.1250552 0.1173152 0.1339773 0.1646837 3.498908 1.740988 1.598292 1.086873 0.9769365 0.7567089 0.6837411 0.6361048 0.6646787 0.697382 0.6928977 0.7620926 0.8712435 
  0.06305786 0.04004838 0.02979936 0.01961984 0.01393184 0.0161655 0.01061693 0.009312749 0.01239547 0.01053673 0.01045952 0.01019757 0.01557178 2.23214 0.7074254 0.4051887 0.2854817 0.2367979 0.2181023 0.159452 0.1400523 0.1404307 0.1451373 0.1408666 0.1571861 0.1949842 11.9033 3.484194 2.799921 1.914496 1.390689 1.240517 0.9818966 0.7645894 0.8660675 0.8166983 0.780809 0.8711964 0.9782949 
  0.0305397 0.02291626 0.01370068 0.008442763 0.009230516 0.008033482 0.006675965 0.006627211 0.007381339 0.008277272 0.00643993 0.006807925 0.01090716 0.7855784 0.291983 0.192392 0.1382253 0.1385253 0.1072706 0.1119985 0.1032752 0.09838256 0.1005278 0.1075132 0.1276021 0.1553851 6.282044 1.700705 1.545574 0.9755589 0.8905205 0.7498338 0.5579467 0.5234929 0.5774056 0.5841293 0.5319812 0.6082525 0.7984611 
  0.04677138 0.04723856 0.0227767 0.01849112 0.01657891 0.01162096 0.0108268 0.01193014 0.01077441 0.01350318 0.00939218 0.01013264 0.01449762 3.451767 1.745704 0.7090577 0.4978528 0.3725268 0.2937118 0.2456003 0.224438 0.2048558 0.202443 0.2015199 0.2111631 0.2386971 29.98471 10.11609 4.665777 3.228997 2.443297 1.741408 1.457251 1.28925 1.24447 1.339478 1.177544 1.217726 1.337027 
  0.02122821 0.01207263 0.01316786 0.01571006 0.01499793 0.009412728 0.009728924 0.01003481 0.009703611 0.01214946 0.01111233 0.01204958 0.01863483 1.411967 1.019404 0.7629314 0.5594261 0.3709828 0.3113294 0.2546077 0.2208646 0.1938432 0.2057275 0.2114413 0.238746 0.2407582 17.86009 6.230998 3.937107 3.037101 1.96599 1.55237 1.296339 1.168563 1.167707 1.220942 1.179688 1.339154 1.290323 
  0.08859547 0.06048081 0.02467246 0.01669089 0.01636723 0.01645487 0.01167441 0.01230768 0.01451627 0.01328279 0.01356688 0.009404474 0.01715533 1.75326 0.7352375 0.3314037 0.2169225 0.2483822 0.2113679 0.1800042 0.165497 0.1650321 0.1674186 0.1590713 0.1710584 0.202961 10.22287 4.894253 2.499493 2.027962 1.729784 1.565189 1.260075 1.082063 1.170893 1.061473 1.081967 1.034569 1.185564 
  0.02918526 0.02412814 0.01354305 0.00563184 0.008858128 0.006629096 0.005577338 0.005901075 0.007304207 0.009028915 0.007961163 0.009098914 0.01155888 0.4872318 0.2658866 0.1630255 0.1245148 0.1140792 0.1102837 0.1042518 0.09556606 0.1094339 0.1017059 0.1078488 0.1212104 0.1604457 3.849266 1.416148 1.332111 0.7052612 0.8525155 0.6712157 0.4978558 0.4869552 0.5967092 0.6501517 0.5721011 0.6765234 0.7941348 ]
</DiagGMM> "
done
} > $mdl_file
